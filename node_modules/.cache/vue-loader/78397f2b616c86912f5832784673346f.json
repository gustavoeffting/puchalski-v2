{"remainingRequest":"/home/gustavo/workspace/puchalski/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/gustavo/workspace/puchalski/src/App.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/home/gustavo/workspace/puchalski/src/App.vue","mtime":1651340943956},{"path":"/home/gustavo/workspace/puchalski/node_modules/css-loader/dist/cjs.js","mtime":1651338534801},{"path":"/home/gustavo/workspace/puchalski/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1651338529857},{"path":"/home/gustavo/workspace/puchalski/node_modules/postcss-loader/src/index.js","mtime":1651338528501},{"path":"/home/gustavo/workspace/puchalski/node_modules/vuetify-loader/lib/loader.js","mtime":1651338529589},{"path":"/home/gustavo/workspace/puchalski/node_modules/cache-loader/dist/cjs.js","mtime":1651338534497},{"path":"/home/gustavo/workspace/puchalski/node_modules/vue-loader/lib/index.js","mtime":1651338529133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKI21haW4tY29udGVudCB7CiAgYmFja2dyb3VuZDogdXJsKCcuL2Fzc2V0cy9iYWNrZ3JvdW5kLnBuZycpIG5vLXJlcGVhdCBjZW50ZXIgY2VudGVyL2NvdmVyOwogIGZvbnQtZmFtaWx5OiAnV29yayBTYW5zJywgc2Fucy1zZXJpZjsKfQoKc3BhbiB7CiAgY29sb3I6ICMxZTE1NTk7Cn0KCiNtYWluLWNvbnRlbnQgLmhvbWUgewogIGhlaWdodDogOTB2aDsKfQoKLmZzLTIwIHsKICBmb250LXNpemU6IDIwcHg7Cn0KCi5mcy0yNSB7CiAgZm9udC1zaXplOiAyNXB4Owp9CgouZnMtMzAgewogIGZvbnQtc2l6ZTogMzBweDsKfQoKLmZzLTM1IHsKICBmb250LXNpemU6IDM1cHg7Cn0KCi5mcy0xMDAgewogIGZvbnQtc2l6ZTogMTAwcHg7Cn0KCi5ibG9jayB7CiAgZGlzcGxheTogYmxvY2s7Cn0KCiNtYWluLWNvbnRlbnQgLmJ0bi1zZWFyY2ggewogIG1hcmdpbjogMCAwIDMwcHggMjBweDsKfQoKLmJhY2tibHVyIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMyk7CiAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOwogIGJvcmRlcjogMXB4IHNvbGlkIHRyYW5zcGFyZW50OwogIG1hcmdpbjogNXB4OwogIGJvcmRlci1yYWRpdXM6IDVweDsKfQoKQG1lZGlhIChtYXgtd2lkdGg6IDYwMHB4KSB7CiAgI21haW4tY29udGVudCAuYnRuLXNlYXJjaCB7CiAgICBtYXJnaW46IDAgMCAzMHB4IDA7CiAgICB3aWR0aDogMTAwJTsKICB9Cn0K"},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwQA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <v-app id=\"main-content\">\n    <v-container>\n      <v-row :class=\"[temperature ? '' : 'home']\" align=\"center\" no-gutters>\n        <v-col>\n          <v-row v-if=\"!temperature\" no-gutters>\n            <v-col cols=\"12\">\n              <span class=\"fs-35 block text-center\">Previsão do tempo</span>\n            </v-col>\n          </v-row>\n          <v-row align=\"center\" justify=\"center\" class=\"pt-4\" no-gutters>\n            <v-col cols=\"12\" sm=\"8\">\n              <v-combobox\n                ref=\"searchCombobox\"\n                v-model=\"addressDummyModel\"\n                @change=\"onAutoCompleteSelection\"\n                @keyup=\"customOnChangeHandler\"\n                @paste=\"customOnChangeHandler\"\n                :items=\"items\"\n                label=\"Digite um local\"\n                color=\"#1e1559\"\n                outlined\n              ></v-combobox>\n            </v-col>\n            <v-col cols=\"12\" sm=\"2\">\n              <v-btn\n                @click=\"getLocationInfo\"\n                class=\"btn-search\"\n                outlined\n                x-large\n                elevation=\"2\"\n                color=\"#1e1559\"\n              >\n                Buscar\n              </v-btn>\n            </v-col>\n          </v-row>\n        </v-col>\n      </v-row>\n      <v-row v-if=\"temperature\" no-gutters>\n        <v-col cols=\"12\">\n          <v-row class=\"mb-10\" no-gutters>\n            <v-col cols=\"12\">\n              <div>\n                <span class=\"fs-100 block text-center\"><b> {{ temperature }}°C </b></span>\n                <span class=\"fs-25 block text-center\"><b> {{ weather }} </b></span>\n                <span class=\"fs-25 block text-center\"> {{ location }} </span>\n                <span class=\"fs-25 block text-center\"> {{ currentDate }} </span>\n              </div>\n            </v-col>\n          </v-row>\n          <v-row>\n            <v-col cols=\"12\">\n              <v-row class=\"backblur\" no-gutters>\n                <v-col>\n                  <span class=\"fs-20 block text-center\">Previsão</span>\n                </v-col>\n              </v-row>\n              <v-row v-for=\"item in forecast\" :key=\"item.id\" align=\"center\" class=\"backblur\" no-gutters>\n                <v-col cols=\"6\">\n                  <span class=\"fs-30 block text-center\"> {{ item.date }} </span>\n                </v-col>\n                <v-col cols=\"6\">\n                  <span class=\"fs-20 block text-center\"> {{ item.temperature }}°C<br> {{ item.weather }} </span>\n                </v-col>\n              </v-row>\n            </v-col>\n          </v-row>\n        </v-col>\n      </v-row>\n    </v-container>\n  </v-app>\n</template>\n\n<script>\nimport { getWeather } from \"./services\"\nexport default {\n  name: 'App',\n\n  data: () => ({\n    address: null,\n    addressDummyModel: null,\n    temperature: null,\n    weather: null,\n    location: null,\n    currentDate: null,\n    forecast: [],\n    comboBoxModel: null,\n    items: []\n  }),\n\n  mounted () {\n    let storedSearches = JSON.parse(localStorage.getItem('storedSearches'))\n\n    if (storedSearches) {\n      this.items = storedSearches\n    }\n  },\n\n  methods: {\n    onAutoCompleteSelection () {\n      this.address = this.addressDummyModel\n    },\n    customOnChangeHandler () {\n      setTimeout (() => {\n        if (this.$refs.searchCombobox) {\n          this.address = this.$refs.searchCombobox.internalSearch\n        }\n      });\n    },\n    async getLocationInfo () {\n      if (!this.address || !this.address.trim()) {\n        return\n      }\n\n      let storeAddress = true\n\n      this.items.forEach((item) => {\n        if (item == this.address) {\n          storeAddress = false\n        }\n      })\n\n      if (storeAddress === true) {\n        this.items.push(this.address)\n        localStorage.setItem('storedSearches', JSON.stringify(this.items))\n      }\n\n      let storedCoordinates = JSON.parse(localStorage.getItem('storedCoordinates'))\n      let lat\n      let lng\n\n      if (storedCoordinates) {\n        storedCoordinates.forEach((item) => {\n          if (item.address == this.address) {\n            lat = item.lat\n            lng = item.lng\n          }\n        })\n      }\n\n      if (lat && lng) {\n        this.getWeatherInfo(lat,lng)\n      } else {\n        const response = await this.axios.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${this.address}&key=${process.env.VUE_APP_GOOGLE_API_KEY}`)\n        if (response.data.results.length === 0) {\n          alert('Não encontrado')\n          return\n        }\n\n        if (!storedCoordinates) {\n          storedCoordinates = []\n        }\n\n        const geocode = {\n          \"address\": this.address,\n          \"lat\": response.data.results[0].geometry.location.lat,\n          \"lng\": response.data.results[0].geometry.location.lng\n        }\n\n        storedCoordinates.push(geocode)\n        localStorage.setItem('storedCoordinates', JSON.stringify(storedCoordinates))\n\n        this.getWeatherInfo(response.data.results[0].geometry.location.lat,response.data.results[0].geometry.location.lng)\n      }\n    },\n    async getWeatherInfo (lat,lng) {\n      const today = new Date()\n      const dd = String(today.getDate()).padStart(2, '0')\n      const mm = String(today.getMonth() + 1).padStart(2, '0')\n      const year = String(today.getYear())\n      this.currentDate = dd + '/' + mm\n\n      const currentHour = dd + '/' + mm + '/' + year + ' - ' + today.getHours()\n\n      let storedWeather = JSON.parse(sessionStorage.getItem('storedWeather'))\n      let findCacheWeather = false\n\n      if (storedWeather) {\n        storedWeather.forEach((item) => {\n          if (item.lastQuery == currentHour && item.lat == lat && item.lng == lng) {\n            this.temperature = item.temperature\n            this.weather = item.weather\n            this.location = item.location\n            findCacheWeather = true\n          }\n        })\n      }\n\n      if (findCacheWeather === false) {\n        const response = await getWeather(lat,lng)\n        this.temperature = Math.round(response.data.main.temp)\n        this.weather = response.data.weather[0].description\n        this.location = response.data.name\n\n        const weatherInfo = {\n          \"lastQuery\": currentHour,\n          \"temperature\": Math.round(response.data.main.temp),\n          \"weather\": response.data.weather[0].description,\n          \"location\": response.data.name,\n          \"lat\": lat,\n          \"lng\": lng\n        }\n\n        if (!storedWeather) {\n          storedWeather = []\n        }\n\n        storedWeather.push(weatherInfo)\n        sessionStorage.setItem('storedWeather', JSON.stringify(storedWeather))\n      }\n\n      let storedForecast = JSON.parse(sessionStorage.getItem('storedForecast'))\n      let findCacheForecast = false\n\n      if (storedForecast) {\n        storedForecast.forEach((item) => {\n          if (item.lastQuery == currentHour && item.lat == lat && item.lng == lng) {\n            this.forecast = item.forecast\n            findCacheForecast = true\n          }\n        })\n      }\n\n      if (findCacheForecast === false) {\n        const response = await getWeather(lat, lng)\n        const forecast = []\n\n        const forecastList = response.data.list.filter( element => {\n          return element.dt_txt.substring(11,13) === '12' // weather at 12h\n        })\n\n        let i = 0\n        for (let item of forecastList) {\n          forecast.push({\n                          'id': i, \n                          'date': item.dt_txt.substring(8,10) + '/' + item.dt_txt.substring(5,7),\n                          'weather': item.weather[0].description,\n                          'temperature': Math.round(item.main.temp)\n                        })\n          i++\n        }\n\n        this.forecast = forecast\n\n        const forecastInfo = {\n          \"lastQuery\": currentHour,\n          \"lat\": lat,\n          \"lng\": lng,\n          \"forecast\": forecast\n        }\n\n        if (!storedForecast) {\n          storedForecast = []\n        }\n\n        storedForecast.push(forecastInfo)\n        sessionStorage.setItem('storedForecast', JSON.stringify(storedForecast))\n      }\n    }\n  }\n}\n</script>\n<style type=\"text/css\">\n#main-content {\n  background: url('./assets/background.png') no-repeat center center/cover;\n  font-family: 'Work Sans', sans-serif;\n}\n\nspan {\n  color: #1e1559;\n}\n\n#main-content .home {\n  height: 90vh;\n}\n\n.fs-20 {\n  font-size: 20px;\n}\n\n.fs-25 {\n  font-size: 25px;\n}\n\n.fs-30 {\n  font-size: 30px;\n}\n\n.fs-35 {\n  font-size: 35px;\n}\n\n.fs-100 {\n  font-size: 100px;\n}\n\n.block {\n  display: block;\n}\n\n#main-content .btn-search {\n  margin: 0 0 30px 20px;\n}\n\n.backblur {\n  background-color: rgba(255, 255, 255, 0.3);\n  backdrop-filter: blur(10px);\n  border: 1px solid transparent;\n  margin: 5px;\n  border-radius: 5px;\n}\n\n@media (max-width: 600px) {\n  #main-content .btn-search {\n    margin: 0 0 30px 0;\n    width: 100%;\n  }\n}\n</style>"]}]}